<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="css/slide_contents01.css">
        <link rel="stylesheet" href="css/slide_contents01_1.css">
        <link rel="stylesheet" href="css/slide_contents01_1_p1.css">
        <link rel="stylesheet" href="css/slide_contents01_1_p2.css">
        <link rel="stylesheet" href="css/slide_contents01_1_p3.css">
        <link rel="stylesheet" href="css/slide_contents01_2.css">
    </head>
    <body>
        <section class="header">
            <h1>スライドコンテンツサンプル</h1>
        </section>
        <div class="HSL01-container">
            <div class="HSL01-body">
<div class="HSL01-table-fixed-side">
    <div class="side-header1">
        <p>月</p>
    </div>
    <div class="side-header2">
        <p>日</p>
    </div>
    <div class="side-header3">
        <p>No</p>
        <p>作業名</p>
        <p>担当</p>
        <p>工数</p>
    </div>
    <div id="HSL01-table-fixed-side-contents">
        <ul><li>1</li><li>作業 #1</li><li>名前 #1</li><li>10</li></ul>
        <ul><li>2</li><li>作業 #2</li><li>名前 #2</li><li>11</li></ul>
        <ul><li>3</li><li>作業 #3</li><li>名前 #3</li><li>12</li></ul>
        <ul><li>4</li><li>作業 #4</li><li>名前 #4</li><li>13</li></ul>
        <ul><li>5</li><li>作業 #5</li><li>名前 #5</li><li>14</li></ul>
        <ul><li>6</li><li>作業 #6</li><li>名前 #6</li><li>15</li></ul>
        <ul><li>7</li><li>作業 #7</li><li>名前 #7</li><li>16</li></ul>
        <ul><li>8</li><li>作業 #8</li><li>名前 #8</li><li>17</li></ul>
        <ul><li>9</li><li>作業 #9</li><li>名前 #9</li><li>18</li></ul>
        <ul><li>10</li><li>作業 #10</li><li>名前 #10</li><li>19</li></ul>
        <ul><li>11</li><li>作業 #11</li><li>名前 #11</li><li>100</li></ul>
        <ul><li>12</li><li>作業 #12</li><li>名前 #12</li><li>110</li></ul>
        <ul><li>13</li><li>作業 #13</li><li>名前 #13</li><li>120</li></ul>
        <ul><li>14</li><li>作業 #14</li><li>名前 #14</li><li>130</li></ul>
        <ul><li>15</li><li>作業 #15</li><li>名前 #15</li><li>140</li></ul>
        <ul><li>16</li><li>作業 #16</li><li>名前 #16</li><li>150</li></ul>
        <ul><li>17</li><li>作業 #17</li><li>名前 #17</li><li>160</li></ul>
        <ul><li>18</li><li>作業 #18</li><li>名前 #18</li><li>170</li></ul>
        <ul><li>19</li><li>作業 #19</li><li>名前 #19</li><li>180</li></ul>
        <ul><li>20</li><li>作業 #20</li><li>名前 #20</li><li>999</li></ul>
    </div>
</div>
<div class="HSL01-table-variable-contents">
    <div>
        <div>
            <div class="contents-header1">
                <p>8月</p>
            </div>
            <div class="contents-header2">
                <p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p>
                <p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p>
                <p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p><p>29</p><p>30</p><p>31</p>
            </div>
            <div class="contents-header3">
                <p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p>
                <p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p>
                <p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p>
            </div>
        </div>
        <div>
            <div class="contents-header1">
                <p>9月</p>
            </div>
            <div class="contents-header2">
                <p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p>
                <p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p>
                <p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p><p>29</p><p>30</p>
            </div>
            <div class="contents-header3">
                <p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p>
                <p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p>
                <p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p>
            </div>
        </div>
        <div>
            <div class="contents-header1">
                <p>10月</p>
            </div>
            <div class="contents-header2">
                <p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p>
                <p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p>
                <p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p><p>29</p><p>30</p><p>31</p>
            </div>
            <div class="contents-header3">
                <p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p>
                <p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p>
                <p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p>
            </div>
        </div>    
    </div>
    <div class="variable-contents">

    </div>
</div>
            </div>
            <div class="HSL01-slide-container">
                <div class="HSL01-slide-body">
                    <div class="HSL01-slide-page-body">
                        <div class="HSL01-slide-page01 HSL01-slide-page-hidden">
<h3>メンバー</h3>
<div class="HSL01-slide-page01-add-member">
    <img src="img/icon003_plus.png" alt="メンバー追加">
</div>
<ul>
    <li><p class="title">会社名</p><p class="title">氏名</p><p class="title">表示名</p></li>
    <li data-member_id="1"><p>(株)グッドワン</p><p>小池 修</p><p>GONE</p></li>
    <li data-member_id="2"><p>(株)ＴＫＣ</p><p>石崎 裕未</p><p>TKC-A</p></li>
    <li data-member_id="3"><p>(株)アイワ</p><p>川村 雅人</p><p>IWA-A</p></li>
    <li data-member_id="4"><p>(株)アイワ</p><p>松村 和豊</p><p>IWA-B</p></li>
</ul>
                        </div>
                    </div>
                    <div class="HSL01-slide-page-body">
                        <div class="HSL01-slide-page02 HSL01-slide-page-hidden">
<h3>作業項目</h3>
<ul>
    <li><img src="img/icon004_arrow_right.png" class="HSL01-list-icon">要件定義</li>
    <li><img src="img/icon004_arrow_right.png" class="HSL01-list-icon">外部設計</li>
    <li><img src="img/icon004_arrow_right.png" class="HSL01-list-icon">内部設計</li>
    <li><img src="img/icon004_arrow_right.png" class="HSL01-list-icon">製造・単体テスト</li>
    <li><img src="img/icon004_arrow_right.png" class="HSL01-list-icon">結合テスト</li>
    <li><img src="img/icon004_arrow_right.png" class="HSL01-list-icon">システムテスト</li>
    <li><img src="img/icon004_arrow_right.png" class="HSL01-list-icon">運用テスト</li>
    <li><img src="img/icon004_arrow_right.png" class="HSL01-list-icon">システム移行</li>
    <li><img src="img/icon004_arrow_right.png" class="HSL01-list-icon">運用・保守</li>
</ul>
                        </div>
                    </div>
                    <div class="HSL01-slide-page-body">
                        <div class="HSL01-slide-page03 HSL01-slide-page-hidden">
<h3>カレンダー設定</h3>
<div>
    <label for="start-date">開始日付：</label>
    <input type="date" id="start-date" name="start-date"/>
</div>
<div>
    <input type="checkbox" id="start-first-date" name="start-first-date" checked/>
    <label for="start-first-date">月初日から表示</label>
</div>
<div>
    <label for="date-period">期間：</label>
    <select id="date-period" name="date-period">
        <option value="1" selected>１ヶ月</option>
        <option value="2">２ヶ月</option>
        <option value="3">３ヶ月</option>
    </select>
</div>
                        </div>
                    </div>
                </div>
                <div class="HSL01-slide-tag">
                    <img src="img/icon001_person_team.png" class="HSL01-slide-page01-tag" alt="メンバー">
                    <img src="img/icon002_items.png" class="HSL01-slide-page02-tag" alt="作業項目">
                    <img src="img/icon006_calendar.png" class="HSL01-slide-page03-tag" alt="カレンダー">
                </div>
            </div>
        </div>
        <script type="text/javascript" src="js/HSL01_slide.js"></script>
        <script>
/**
 * カレンダークラス
 */
class HSL01_Calender {
    /**
     * 指定日付の月末日を取得する.
     */
    getLastDate(thisDate) {
        return new Date(thisDate.getFullYear(), thisDate.getMonth() + 1, 0);
    }
    makeDayList(today, isStart1stDay) {
        const lastDate = this.getLastDate(today);      // 月末の日付
        const firstDate = isStart1stDay ? 1 : today.getDate();
        let dayWork = new Date(today.getFullYear(), today.getMonth(), firstDate);
        const dayList = [];
        while (dayWork <= lastDate) {
            dayList.push(new Date(dayWork.getTime()));
            dayWork.setDate(dayWork.getDate() + 1);
        }
        return dayList;
    }
    /**
     * カレンダー情報を作成する.
     * 2022
     *      11  1 - 30
     *      12  1 - 31
     * 2023
     *      1   1 - 31
     *      2   1 - 28
     */
    getCalenderList(fromDate, isStart1stDay, numberOfMonth) {
        const calender = [];
        let monthList = null;
        let flag = isStart1stDay;
        let now = new Date(fromDate.getFullYear(), fromDate.getMonth(), fromDate.getDate());
        for (let monthCount = 0; monthCount < numberOfMonth; ++monthCount) {
            if (!monthList) monthList = [];
            monthList.push(this.makeDayList(now, flag));
            var nextMonth = fromDate.getMonth() + 1;
            if (nextMonth < 12) {
                now = new Date(now.getFullYear(), nextMonth, 1);
            } else {
                calender.push(monthList);
                now = new Date(now.getFullYear() + 1, 1, 1);
            }
            flag = false;
        }
        if (monthList && !calender.includes(monthList)) calender.push(monthList);
        return calender;
    }
}

function HSL01_init_getWorkItems() {
    let items = [];
    // 作業項目の一覧を取得
    try {
        let tags = document.getElementsByClassName('HSL01-slide-page02');
        if (tags.length !==1) throw 'HSL01-slide-page02 class not found !';
        tags = tags.item(0).getElementsByTagName('ul');
        if (tags.length !==1) throw 'list tag not found !';
        tags = tags.item(0).getElementsByTagName('li');
        if (tags.length === 0) throw '作業項目が未設定です.';
        for (var liTag of tags) {
            items.push(liTag.textContent);
        }
    } catch (ex) {
        alert(ex);
    } finally {
        return items;
    }
}

function clearTableBody(element) {
    try {
        let tags = document.getElementsByClassName('HSL01-body-table-body');
        if (tags.length !== 1) throw 'not selected body !'
        tags = tags.item(0).getElementsByClassName('HSL01-body-table-body-contents')
        if (tags.length !== 2) throw 'not selected title and date in body !'
        for (let index = 0; index < tags.length; ++index) {
            let tbody = tags.item(index);
            while (tbody.firstChild) {
                tbody.removeChild(tbody.firstChild);
            }
        }
    } catch (ex) {
        alert(ex);
    }
}

function HSL01_init_calender() {
    try {
        let tag = document.getElementById('start-date');
        if (!tag) throw 'start-date input tag not found !';
        const today = new Date();
        tag.valueAsDate = today;

        tag = document.getElementById('start-first-date');
        if (!tag) throw 'start-first-date input tag not found !';
        const start1stDate = tag.checked;

        tag = document.getElementById('date-period');
        if (!tag) throw 'date-period input tag not found !';
        const numberOfMonth = tag.options[tag.selectedIndex].value;

        const calender = new HSL01_Calender();
        const calenderData = calender.getCalenderList(today, start1stDate, numberOfMonth);
        //console.log(calenderData);
        return calenderData;
    } catch (ex) {
        alert(ex);
        return [];
    }
}

function HSL01_init_calender_header(calenderData) {
    try {
        let tags = document.getElementsByClassName('HSL01-body-table-header-date');
        if (tags.length !== 1) throw 'not selected calender header !';
        const headerCalender = tags.item(0);
        while (headerCalender.firstChild) {
            headerCalender.removeChild(headerCalender.firstChild);
        }
        for (let monthList of calenderData) {
            for (let month of monthList) {
                for (let date of month) {
                    let p = document.createElement('p');
                    p.appendChild(document.createTextNode(date.getDate()));
                    let li = document.createElement('li');
                    li.appendChild(p);
                    let dayOfWeek = date.getDay();
                    if (dayOfWeek === 0) {
                        p.classList.add('HSL01-calender-sun');
                    } else if (dayOfWeek === 6) {
                        p.classList.add('HSL01-calender-sat');
                    }
                    headerCalender.appendChild(li);
                }
            }
        }
    } catch (ex) {
        alert(ex);
    }
}

function HSL01_table_contents_title(data) {
    let p = document.createElement('p');
    p.appendChild(document.createTextNode(data));
    let li = document.createElement('li');
    li.appendChild(p);
    return li;
}

function HSL01_init_table_contents() {
    try {
        let tags = document.getElementsByClassName('HSL01-body-table-body');
        if (tags.length !== 1) throw 'not selected body !'
        tags = tags.item(0).getElementsByClassName('HSL01-body-table-body-contents')
        if (tags.length !== 2) throw 'not selected title and date in body !'
        let title = tags.item(0);
        let workItemList = HSL01_init_getWorkItems();
        if (workItemList.length < 1) return;
        // console.log(workItemList);
        let no = 1;
        for (const item of workItemList) {
            let ul = document.createElement('ul');

            ul.appendChild(HSL01_table_contents_title(no++));
            ul.appendChild(HSL01_table_contents_title(item));
            ul.appendChild(HSL01_table_contents_title(''));
            ul.appendChild(HSL01_table_contents_title(''));

            title.appendChild(ul);
        }

        let date = tags.item(0);
        // TODO
    } catch (ex) {
        alert(ex);
    }
}

function HSL01_init_body() {
    clearTableBody();
    HSL01_init_table_contents();
    const calenderData = HSL01_init_calender();
    HSL01_init_calender_header(calenderData);
}

/*
window.addEventListener('load', (event) => {
    //console.log('start content slider sample');
//TODO    HSL01_init_body();
    document.addEventListener('click', HSL01_clickEvent);
});
*/
const mySlider = new HSL01_Slide();
mySlider.start_slide();
        </script>
    </body>
</html>